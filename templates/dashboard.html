{% extends "base.html" %}

{% block content %}

<section class="nc-section nc-scale">
    <h2 class="nc-title">Ol√°, {{ usuario.nome }} üëã</h2>

    <div class="nc-user-status small">
        <div>
            <span class="label">Acesso:</span>
            {% if session.get('is_master') %}
                <span class="role master">MASTER</span>
            {% elif session.get('is_admin') %}
                <span class="role admin">ADMINISTRADOR</span>
            {% else %}
                <span class="role user">Usu√°rio</span>
            {% endif %}
        </div>

        <div>
            <span class="label">Empresa:</span>
            {% if session.get('is_master') %}
                ‚Äî (usu√°rio MASTER sem v√≠nculo)
            {% else %}
                {{ usuario.empresa_nome }}
            {% endif %}
        </div>
    </div>

    <div class="nc-dashboard-actions compact">
        <a href="{{ url_for('operacoes.importar_page') }}" class="nc-btn-primary small">‚¨ÜÔ∏è Importar</a>
        <a href="{{ url_for('operacoes.conciliar_page') }}" class="nc-btn-secondary small">‚úîÔ∏è Concilia√ß√£o</a>
        <a href="{{ url_for('operacoes.detalhado_page') }}" class="nc-btn-gray small">üìÖ Detalhamento</a>
    </div>
</section>


<section class="nc-section nc-scale">
    <h2 class="nc-subtitle small">Vis√£o Geral</h2>

    <div class="nc-kpis small">

        <div class="nc-kpi-card small">
            <div class="kpi-icon kpi-blue small">üõçÔ∏è</div>
            <div class="kpi-info small">
                <div class="kpi-label small">Total Vendas</div>
                <div class="kpi-value kpi-value-vendas small">R$ 0,00</div>
            </div>
        </div>

        <div class="nc-kpi-card small">
            <div class="kpi-icon kpi-green small">üí∏</div>
            <div class="kpi-info small">
                <div class="kpi-label small">Total Recebido</div>
                <div class="kpi-value kpi-value-recebido small">R$ 0,00</div>
            </div>
        </div>

        <div class="nc-kpi-card small">
            <div class="kpi-icon kpi-yellow small">‚ö†Ô∏è</div>
            <div class="kpi-info small">
                <div class="kpi-label small">Diferen√ßa</div>
                <div class="kpi-value kpi-value-diferenca small">0,00</div>
            </div>
        </div>

        <div class="nc-kpi-card small">
            <div class="kpi-icon kpi-red small">üîî</div>
            <div class="kpi-info small">
                <div class="kpi-label small">Alertas</div>
                <div class="kpi-value kpi-value-alertas small">0</div>
            </div>
        </div>

    </div>
</section>


<section class="nc-section nc-scale">
    <h2 class="nc-subtitle small">Totais por Adquirente</h2>
    <div id="acqContainer" class="nc-acq-grid small"></div>
</section>


<section class="nc-section nc-scale">
    <h2 class="nc-subtitle small">Gr√°fico de Vendas x Recebido</h2>

    <div class="nc-graphs-container small">
        <canvas id="graficoVendasRecebidos"></canvas>
    </div>
</section>


<section class="nc-section nc-scale">
    <h2 class="nc-subtitle small">Vendas por Bandeira</h2>

    <div class="nc-graphs-container small">
        <canvas id="graficoBandeiras"></canvas>
    </div>
</section>


<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>

<style>

/* === Escala Geral Reduzida (aprox -40%) === */
.nc-scale { font-size: 0.62rem !important; }
.nc-scale .small { font-size: 0.62rem !important; }

.nc-dashboard-actions.compact a {
    padding: 6px 10px !important;
    font-size: 0.62rem !important;
}

/* Ajuste dos KPI Cards menores */
.nc-kpi-card.small {
    padding: 8px !important;
}

.kpi-icon.small {
    font-size: 20px !important;
}

.kpi-value.small {
    font-size: 0.9rem !important;
}

.kpi-label.small {
    font-size: 0.7rem !important;
}

/* Adquirentes */
.nc-acq-grid.small {
    gap: 8px !important;
}

.nc-acq-card {
    padding: 10px !important;
    border-radius: 10px;
}

.nc-acq-icon {
    font-size: 20px;
}

.nc-acq-value {
    font-size: 0.9rem;
}

/* Bot√£o cinza */
.nc-btn-gray.small {
    background: #e5e5e5;
    padding: 6px 12px;
    border-radius: 8px;
    font-size: 0.62rem;
    display: inline-block;
    border: 1px solid #ccc;
}

.nc-btn-gray.small:hover {
    background: #d9d9d9;
}

/* Cores personalizadas adquirentes */
.acq-cielo { color: #0071ce; }
.acq-rede { color: #ff6600; }
.acq-getnet { color: #cc0000; }
.acq-stone { color: #0fa968; }
.acq-pagseguro { color: #13a300; }
.acq-outros { color: #444; }

</style>

{% endblock %}
