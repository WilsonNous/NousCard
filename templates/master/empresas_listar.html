{% extends "base.html" %}

{% block title %}Master - Empresas - NousCard{% endblock %}

{% block content %}
<section class="nc-section">
    <div class="nc-section-header">
        <div>
            <h2>ğŸ¢ Master - Gerenciar Empresas</h2>
            {% if empresas and empresas.total %}
            <p class="nc-section-subtitle">{{ empresas.total }} empresa(s) cadastrada(s)</p>
            {% endif %}
        </div>
        <a href="{{ url_for('master.empresa_nova') }}" class="nc-btn nc-btn-primary">+ Nova Empresa</a>
    </div>
    
    {% if empresas and empresas.items %}
        <table class="nc-table" role="table" aria-label="Lista de empresas">
            <caption class="nc-sr-only">Tabela com {{ empresas.total }} empresas gerenciadas pelo master.</caption>
            <thead>
                <tr>
                    <th scope="col">ID</th>
                    <th scope="col">Nome</th>
                    <th scope="col">Admin</th>
                    <th scope="col">Criada em</th>
                    <th scope="col" class="nc-sr-only">AÃ§Ãµes</th>
                </tr>
            </thead>
            <tbody>
                {% for e in empresas.items %}
                <tr>
                    <td>{{ e.id }}</td>
                    <td><strong>{{ e.nome | e }}</strong></td>
                    <td>{{ e.usuarios[0].email if e.usuarios else "â€”" }}</td>
                    <td>{{ e.criado_em.strftime("%d/%m/%Y") if e.criado_em else "-" }}</td>
                    <td class="nc-table-actions">
                        <a href="{{ url_for('master.empresa_ver', empresa_id=e.id) }}" 
                           class="nc-btn nc-btn-sm nc-btn-outline"
                           aria-label="Ver empresa {{ e.nome | e }}">
                            <span aria-hidden="true">ğŸ‘ï¸</span>
                            <span class="nc-sr-only">Ver</span>
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        
        {% if empresas.pages > 1 %}
        <nav class="nc-pagination" role="navigation" aria-label="PaginaÃ§Ã£o">
            {% if empresas.has_prev %}
            <a href="?page={{ empresas.prev_num }}" class="nc-btn nc-btn-sm" aria-label="PÃ¡gina anterior">â† Anterior</a>
            {% endif %}
            <span class="nc-page-info">PÃ¡gina {{ empresas.page }} de {{ empresas.pages }}</span>
            {% if empresas.has_next %}
            <a href="?page={{ empresas.next_num }}" class="nc-btn nc-btn-sm" aria-label="PrÃ³xima pÃ¡gina">PrÃ³xima â†’</a>
            {% endif %}
        </nav>
        {% endif %}
        
    {% else %}
        <div class="nc-empty-state" role="status">
            <span aria-hidden="true">ğŸ¢</span>
            <h3>Nenhuma empresa cadastrada</h3>
            <p>Comece criando a primeira empresa.</p>
            <a href="{{ url_for('master.empresa_nova') }}" class="nc-btn nc-btn-primary">+ Nova Empresa</a>
        </div>
    {% endif %}
</section>
{% endblock %}
