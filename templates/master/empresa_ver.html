{% extends "base.html" %}

{% block title %}{{ empresa.nome }} - Master - NousCard{% endblock %}

{% block content %}
<section class="nc-section">
    <div class="nc-section-header">
        <div>
            <h2>ğŸ¢ {{ empresa.nome | e }}</h2>
            <p class="nc-subtitle">ID: {{ empresa.id }} â€¢ Criada em: {{ empresa.criado_em.strftime("%d/%m/%Y") if empresa.criado_em else "â€”" }}</p>
        </div>
        <div class="nc-actions">
            <a href="{{ url_for('master.usuario_novo', empresa_id=empresa.id) }}" class="nc-btn nc-btn-primary">+ Novo UsuÃ¡rio</a>
            <a href="{{ url_for('master.empresas_listar') }}" class="nc-btn nc-btn-outline">â† Voltar</a>
        </div>
    </div>
    
    <h3>UsuÃ¡rios ({{ usuarios|length }})</h3>
    
    {% if usuarios %}
        <table class="nc-table">
            <thead>
                <tr>
                    <th scope="col">Nome</th>
                    <th scope="col">E-mail</th>
                    <th scope="col">Admin</th>
                    <th scope="col">Criado em</th>
                    <th scope="col" class="nc-sr-only">AÃ§Ãµes</th>
                </tr>
            </thead>
            <tbody>
                {% for u in usuarios %}
                <tr>
                    <td>{{ u.nome | e }}</td>
                    <td>{{ u.email | e }}</td>
                    <td>{{ "Sim" if u.admin else "NÃ£o" }}</td>
                    <td>{{ u.criado_em.strftime("%d/%m/%Y") if u.criado_em else "-" }}</td>
                    <td class="nc-table-actions">
                        {% if u.id != session.get('usuario_id') %}
                        <form method="POST" action="{{ url_for('master.usuario_remover', empresa_id=empresa.id, user_id=u.id) }}" style="display:inline;" onsubmit="return confirm('Remover usuÃ¡rio {{ u.email | e }}?')">
                            <button type="submit" class="nc-btn nc-btn-sm nc-btn-danger" aria-label="Remover usuÃ¡rio">
                                <span aria-hidden="true">ğŸ—‘ï¸</span>
                                <span class="nc-sr-only">Remover</span>
                            </button>
                        </form>
                        {% else %}
                        <span class="nc-badge nc-badge-locked" title="NÃ£o pode remover a si mesmo">ğŸ”’</span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <div class="nc-empty-state">
            <p>Nenhum usuÃ¡rio cadastrado nesta empresa.</p>
        </div>
    {% endif %}
    
    <div class="nc-section-divider"></div>
    
    <h3 class="nc-danger-zone">âš ï¸ Zona de Perigo</h3>
    <div class="nc-danger-zone-content">
        <p>Excluir esta empresa removerÃ¡ permanentemente todos os dados associados.</p>
        <form method="POST" action="{{ url_for('master.empresa_remover', empresa_id=empresa.id) }}" onsubmit="return confirm('âš ï¸ ATENÃ‡ÃƒO: Esta aÃ§Ã£o nÃ£o pode ser desfeita. Excluir empresa {{ empresa.nome | e }}?')">
            <button type="submit" class="nc-btn nc-btn-danger">ğŸ—‘ï¸ Excluir Empresa</button>
        </form>
    </div>
</section>
{% endblock %}
